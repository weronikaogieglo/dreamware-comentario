apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "demo-recreate-db.fullname" . }}-db-reset
  labels:
    {{- include "demo-recreate-db.labels" . | nindent 4 }}
data:
  db-reset.sh: |-
    # Extract connection data and credentials from secrets
    host="$(sed     -ne '/^postgres:/,/^$/ p' /secrets.yaml | grep 'host:'     | tr -s ' ' | cut -d ' ' -f 3)"
    port="$(sed     -ne '/^postgres:/,/^$/ p' /secrets.yaml | grep 'port:'     | tr -s ' ' | cut -d ' ' -f 3)"
    database="$(sed -ne '/^postgres:/,/^$/ p' /secrets.yaml | grep 'database:' | tr -s ' ' | cut -d ' ' -f 3)"
    username="$(sed -ne '/^postgres:/,/^$/ p' /secrets.yaml | grep 'username:' | tr -s ' ' | cut -d ' ' -f 3)"
    password="$(sed -ne '/^postgres:/,/^$/ p' /secrets.yaml | grep 'password:' | tr -s ' ' | cut -d ' ' -f 3)"

    # Store them in a pgpass file
    echo "$host:$port:$database:$username:$password" > /tmp/pgpass
    chmod 600 /tmp/pgpass
    export PGPASSFILE=/tmp/pgpass

    # Run the DB reset script
    psql --host="$host" --port="$port" --dbname="$database" --username="$username" -f /db-reset/db-reset.sql

  db-reset.sql: |-
    -- Cleanup all transient data
    delete from cm_auth_sessions;
    delete from cm_tokens;
    delete from cm_user_sessions where ts_created < current_timestamp - interval '7 days';

    -- Cleanup other irrelevant data
    delete from cm_comment_votes where ts_voted < current_timestamp - interval '7 days';
    delete from cm_domain_attrs;
    delete from cm_user_attrs;

    -- Cleanup obsolete stats
    delete from cm_domain_page_views where ts_created < current_timestamp - interval '30 days';

    -- Reset the dynamic config to its defaults
    delete from cm_configuration;
    delete from cm_domain_configuration;

    -- Disable images to mitigate possible attack (user IP disclosure via a logger)
    insert into cm_domain_configuration (domain_id, key, value, ts_updated, user_updated)
        values
            ('3bcdd9c0-5e9b-4724-9d87-8c520fb2b5c2', 'markdown.images.enabled', 'false', '2024-04-01 10:11:46', '00000000-0000-0000-0000-000000000001');

    -- Remove all users except the Anonymous and demo users
    delete from cm_users where id not in (
        '00000000-0000-0000-0000-000000000000',
        '39a71854-bcfd-42d5-af62-5e931d7a72d8',
        '0ae8c474-ff4c-4950-baf3-975c370dc205',
        '60bfb728-340e-44d5-9e53-149f7d2f6e6a');
    insert into cm_users(id, email, name, password_hash, is_superuser, confirmed, ts_confirmed, ts_created, website_url, secret_token, failed_login_attempts, is_locked)
        values (
            '39a71854-bcfd-42d5-af62-5e931d7a72d8',
            'admin@admin',
            'Voice of Comentario',
            '$2a$10$yOoQaQSdPj5WyUwKLZsaJeb1Fu/4PvUrG5zea6NBLH3f9BHWlWnRS', -- 'admin'
            true,
            true,
            '2023-06-14 15:33:53.383519',
            '2023-06-14 15:33:53.383519',
            'https://comentario.app/',
            'e49269dc-1c31-48cf-bd14-d86b7ade266e',
            0,
            false),
        (
            '0ae8c474-ff4c-4950-baf3-975c370dc205',
            'moderator@moderator',
            'Moderator John',
            '$2a$10$GPoOmmhFOL7wo0QZMtlbcOuH1l9BsjbrCoJuclHyieTR704dvMwIC', -- 'moderator'
            false,
            true,
            '2023-10-27 08:21:04',
            '2023-10-27 08:21:04',
            '',
            'c421998c-daa0-468e-a610-61120940d29f',
            0,
            false),
        (
            '60bfb728-340e-44d5-9e53-149f7d2f6e6a',
            'test@test',
            'I am Commenter',
            '$2a$10$NRp62h1E765Rh.VqMfvz2OS9EG92v/BReep4NJbVa7PEKYTWAAJPu', -- 'test'
            false,
            true,
            '2023-10-27 08:19:20',
            '2023-10-27 08:19:20',
            '',
            '3b357689-27c1-4f2b-a829-72f7bb56f9da',
            0,
            false)
        on conflict (id) do update
            set
                email                 = excluded.email,
                name                  = excluded.name,
                password_hash         = excluded.password_hash,
                is_superuser          = excluded.is_superuser,
                confirmed             = excluded.confirmed,
                website_url           = excluded.website_url,
                failed_login_attempts = excluded.failed_login_attempts,
                is_locked             = excluded.is_locked;

    -- Delete all domains except demo.comentario.app
    delete from cm_domains where id != '9f0b8563-f29e-456e-b53b-3c83fb068b58';
    insert into cm_domains(id, name, host, ts_created, is_https, is_readonly, auth_anonymous, auth_local, auth_sso, mod_anonymous, mod_authenticated, mod_num_comments, mod_user_age_days, mod_links, mod_images, mod_notify_policy, default_sort, count_comments, count_views)
        values (
            '9f0b8563-f29e-456e-b53b-3c83fb068b58',
            'Demo',
            'demo.comentario.app',
            '2023-01-17 17:56:10.966890',
            true,
            false,
            true,
            true,
            false,
            false,
            false,
            0,
            0,
            false,
            false,
            'pending',
            'ta',
            3,
            0)
        on conflict (id) do update
            set
                name              = excluded.name,
                host              = excluded.host,
                is_https          = excluded.is_https,
                is_readonly       = excluded.is_readonly,
                auth_anonymous    = excluded.auth_anonymous,
                auth_local        = excluded.auth_local,
                auth_sso          = excluded.auth_sso,
                mod_anonymous     = excluded.mod_anonymous,
                mod_authenticated = excluded.mod_authenticated,
                mod_num_comments  = excluded.mod_num_comments,
                mod_user_age_days = excluded.mod_user_age_days,
                mod_links         = excluded.mod_links,
                mod_images        = excluded.mod_images,
                mod_notify_policy = excluded.mod_notify_policy,
                default_sort      = excluded.default_sort;

    -- Relink IdPs to demo.comentario.app
    delete from cm_domains_idps;
    insert into cm_domains_idps(domain_id, fed_idp_id)
        values
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'facebook'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'gitlab'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'github'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'google'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'oidc:linkedin'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'twitter');

    -- Reconfigure demo.comentario.app's extensions, remove all other extension config
    delete from cm_domains_extensions;
    insert into cm_domains_extensions(domain_id, extension_id, config)
        values('9f0b8563-f29e-456e-b53b-3c83fb068b58', 'perspective', 'toxicity=0.5');

    -- Remove all domain users except demo ones
    delete from cm_domains_users where (domain_id, user_id) not in (
        ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '39a71854-bcfd-42d5-af62-5e931d7a72d8'),
        ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '0ae8c474-ff4c-4950-baf3-975c370dc205'),
        ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '60bfb728-340e-44d5-9e53-149f7d2f6e6a'));
    insert into cm_domains_users(domain_id, user_id, is_owner, is_moderator, is_commenter, notify_replies, notify_moderator, notify_comment_status, ts_created)
        values
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '39a71854-bcfd-42d5-af62-5e931d7a72d8', true,   true,   true,  false, false, false, '2023-01-17 17:55:47'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '0ae8c474-ff4c-4950-baf3-975c370dc205', false,  true,   true,  false, false, false, '2023-10-27 08:29:37'),
            ('9f0b8563-f29e-456e-b53b-3c83fb068b58', '60bfb728-340e-44d5-9e53-149f7d2f6e6a', false,  false,  true,  false, false, false, '2023-10-27 08:29:44')
        on conflict (domain_id, user_id) do update
            set
                is_owner              = excluded.is_owner,
                is_moderator          = excluded.is_moderator,
                is_commenter          = excluded.is_commenter,
                notify_replies        = excluded.notify_replies,
                notify_moderator      = excluded.notify_moderator,
                notify_comment_status = excluded.notify_comment_status;

    -- Remove all pages except the root one
    delete from cm_domain_pages where id not in (
          'f88fffb2-c354-494b-94f4-aae1a84653c3',
          '58229d71-1667-46d9-a6c6-f7f5444c965e',
          'f4ca56c5-22f1-41fa-a4c2-e6d815530cf8',
          '86c5e9b9-c4c2-4c26-accc-0f221da08ae4',
          'c8cacdee-0622-4ad8-b38a-fdbf5cb8e99c',
          '97c872de-cfbb-4d9c-a41c-a5840559ec44');
    insert into cm_domain_pages(id, domain_id, path, title, is_readonly, ts_created, count_comments, count_views)
        values
            ('f88fffb2-c354-494b-94f4-aae1a84653c3', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/',       'Comentario Demo',          false, current_timestamp, 3, 0),
            ('58229d71-1667-46d9-a6c6-f7f5444c965e', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/es/',    'Comentario Demo',          false, current_timestamp, 2, 0),
            ('f4ca56c5-22f1-41fa-a4c2-e6d815530cf8', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/fr/',    'Comentario Démonstration', false, current_timestamp, 2, 0),
            ('86c5e9b9-c4c2-4c26-accc-0f221da08ae4', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/nl/',    'Comentario Demo',          false, current_timestamp, 2, 0),
            ('c8cacdee-0622-4ad8-b38a-fdbf5cb8e99c', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/pt-br/', 'Comentario Demo',          false, current_timestamp, 2, 0),
            ('97c872de-cfbb-4d9c-a41c-a5840559ec44', '9f0b8563-f29e-456e-b53b-3c83fb068b58', '/ru/',    'Демо-сайт Comentario',     false, current_timestamp, 2, 0)
        on conflict (id) do update
            set
                domain_id   = excluded.domain_id,
                path        = excluded.path,
                title       = excluded.title,
                is_readonly = excluded.is_readonly;

    -- Cleanup comments older than a week
    delete from cm_comments where ts_created < current_timestamp - interval '7 days';
    insert into cm_comments(id, parent_id, page_id, markdown, html, score, is_sticky, is_approved, is_pending, is_deleted, ts_created, user_created, pending_reason)
        values
            -- English
            ('53e9b427-7e46-4ec9-8797-0c28029a557f',
                null,
                'f88fffb2-c354-494b-94f4-aae1a84653c3',
                E'Feel free to leave a comment below, and otherwise to experiment with Comentario on this page! You can also register or login with email `admin@admin` and password `admin` — and do check out the **[Administration UI](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *This demo Comentario instance will be reset nightly, and its comments weekly.*',
                '<p>Feel free to leave a comment below, and otherwise to experiment with Comentario on this page! You can also register or login with email <code>admin@admin</code> and password <code>admin</code> — and do check out the <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Administration UI</a></strong>!</p><hr><p>💡 <em>This demo Comentario instance will be reset nightly, and its comments weekly.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 01 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('bf650fa8-fd95-4638-a9b2-e71d5cc69a34',
                '53e9b427-7e46-4ec9-8797-0c28029a557f',
                'f88fffb2-c354-494b-94f4-aae1a84653c3',
                E'**Note:** please be aware that, since the Admin UI in this demo is open to anyone, any data you enter (such as email) will become publicly accessible until the next reset.',
                '<p><strong>Note:</strong> please be aware that, since the Admin UI in this demo is open to anyone, any data you enter (such as email) will become publicly accessible until the next reset.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 02 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('a5c033de-3396-4448-8356-0052e976d3c7',
                null,
                'f88fffb2-c354-494b-94f4-aae1a84653c3',
                'This comment is fishy and pending moderation!',
                '<p>This comment is fishy and pending moderation!</p>',
                0,
                false,
                false,
                true,
                false,
                current_timestamp - interval '6 days 20 hours 03 minutes',
                '00000000-0000-0000-0000-000000000000',
                'There''s something fishy here!'),
            -- Spanish
            ('c2caab91-1eab-4d63-b0a6-1194fe131b21',
                null,
                '58229d71-1667-46d9-a6c6-f7f5444c965e',
                E'No dudes en dejar un comentario a continuación, y si no, ¡experimenta con Comentario en esta página! También puedes registrarte o iniciar sesión con el correo electrónico `admin@admin` y la contraseña `admin` - ¡y echa un vistazo a la **[Administration UI](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *Esta instancia de demostración de Comentario se restablecerá cada noche, y sus comentarios cada semana.*',
                '<p>No dudes en dejar un comentario a continuación, y si no, ¡experimenta con Comentario en esta página! También puedes registrarte o iniciar sesión con el correo electrónico <code>admin@admin</code> y la contraseña <code>admin</code> - ¡y echa un vistazo a la <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Administration UI</a></strong>!</p><hr><p>💡 <em>Esta instancia de demostración de Comentario se restablecerá cada noche, y sus comentarios cada semana.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 04 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('84fb9c17-58c5-40bb-9d30-582475de6276',
                'c2caab91-1eab-4d63-b0a6-1194fe131b21',
                '58229d71-1667-46d9-a6c6-f7f5444c965e',
                E'**Nota:** ten en cuenta que, dado que la interfaz de administración de esta demostración está abierta a todo el mundo, cualquier dato que introduzcas (como el correo electrónico) será de acceso público hasta el siguiente restablecimiento.',
                '<p><strong>Nota:</strong> ten en cuenta que, dado que la interfaz de administración de esta demostración está abierta a todo el mundo, cualquier dato que introduzcas (como el correo electrónico) será de acceso público hasta el siguiente restablecimiento.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 05 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            -- French
            ('6829f152-21ea-4ccb-9df6-a159152d40de',
                null,
                'f4ca56c5-22f1-41fa-a4c2-e6d815530cf8',
                E'N''hésitez pas à laisser un commentaire ci-dessous, et à expérimenter le Comentario sur cette page ! Vous pouvez aussi vous enregistrer ou vous connecter avec l''email `admin@admin` et le mot de passe `admin` - et jetez un coup d''oeil à la **[Administration UI](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *Cette instance de démonstration de Comentario sera réinitialisée toutes les nuits, et ses commentaires toutes les semaines.*',
                '<p>N''hésitez pas à laisser un commentaire ci-dessous, et à expérimenter le Comentario sur cette page ! Vous pouvez aussi vous enregistrer ou vous connecter avec l''email <code>admin@admin</code> et le mot de passe <code>admin</code> — et jetez un coup d''oeil à la <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Administration UI</a></strong>!</p><hr><p>💡 <em>Cette instance de démonstration de Comentario sera réinitialisée toutes les nuits, et ses commentaires toutes les semaines.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 06 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('75b7a25d-453e-468f-98e6-407fc5c5515a',
                '6829f152-21ea-4ccb-9df6-a159152d40de',
                'f4ca56c5-22f1-41fa-a4c2-e6d815530cf8',
                E'**Note:** veuillez noter que, puisque l''interface d''administration de cette démo est ouverte à tous, toutes les données que vous saisissez (comme l''adresse électronique) seront accessibles au public jusqu''à la prochaine réinitialisation.',
                '<p><strong>Note:</strong> veuillez noter que, puisque l''interface d''administration de cette démo est ouverte à tous, toutes les données que vous saisissez (comme l''adresse électronique) seront accessibles au public jusqu''à la prochaine réinitialisation.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 07 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            -- Dutch
            ('065822de-e18a-48dd-ba0b-375e10add12d',
                null,
                '86c5e9b9-c4c2-4c26-accc-0f221da08ae4',
                E'Voel je vrij om hieronder een comment achter te laten, en anders om te experimenteren met Comentario op deze pagina! Je kunt je ook registreren of inloggen met e-mailadres `admin@admin` en wachtwoord `admin`. En bekijk maar de **[Administration UI](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *Deze demo Comentario-instantie wordt elke nacht gereset en haar comments wekelijks.*',
                '<p>Voel je vrij om hieronder een comment achter te laten, en anders om te experimenteren met Comentario op deze pagina! Je kunt je ook registreren of inloggen met e-mailadres <code>admin@admin</code> en wachtwoord <code>admin</code>. En bekijk maar de <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Administration UI</a></strong>!</p><hr><p>💡 <em>Deze demo Comentario-instantie wordt elke nacht gereset en haar comments wekelijks.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 08 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('21f731d4-425b-48fc-b621-80e8dcc165bd',
                '065822de-e18a-48dd-ba0b-375e10add12d',
                '86c5e9b9-c4c2-4c26-accc-0f221da08ae4',
                E'**Opmerking:** houd er rekening mee dat, aangezien de Admin UI in deze demo voor iedereen toegankelijk is, alle gegevens die je invoert (zoals e-mailadres) openbaar toegankelijk worden tot de eerstvolgende reset.',
                '<p><strong>Opmerking:</strong> houd er rekening mee dat, aangezien de Admin UI in deze demo voor iedereen toegankelijk is, alle gegevens die je invoert (zoals e-mailadres) openbaar toegankelijk worden tot de eerstvolgende reset.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 09 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            -- Portuguese (Brazil)
            ('2aa6814c-9084-412e-9529-41d654810b4f',
                null,
                'c8cacdee-0622-4ad8-b38a-fdbf5cb8e99c',
                E'Sinta-se à vontade para deixar um comentário abaixo e também para experimentar o Comentario nesta página! Você também pode se registrar ou fazer login com o e-mail `admin@admin` e a senha `admin` — e conferir a **[Administration UI](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *Essa instância de demonstração do Comentario será reiniciada todas as noites, e seus comentários, semanalmente.*',
                '<p>Sinta-se à vontade para deixar um comentário abaixo e também para experimentar o Comentario nesta página! Você também pode se registrar ou fazer login com o e-mail <code>admin@admin</code> e a senha <code>admin</code> — e conferir a <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Administration UI</a></strong>!</p><hr><p>💡 <em>Essa instância de demonstração do Comentario será reiniciada todas as noites, e seus comentários, semanalmente.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 10 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('d9a1c15e-ef62-4c59-89a2-497b3526a823',
                '2aa6814c-9084-412e-9529-41d654810b4f',
                'c8cacdee-0622-4ad8-b38a-fdbf5cb8e99c',
                E'**Nota:** esteja ciente de que, como a interface de usuário do administrador nesta demonstração está aberta a qualquer pessoa, todos os dados inseridos (como e-mail) ficarão acessíveis ao público até a próxima redefinição.',
                '<p><strong>Nota:</strong> esteja ciente de que, como a interface de usuário do administrador nesta demonstração está aberta a qualquer pessoa, todos os dados inseridos (como e-mail) ficarão acessíveis ao público até a próxima redefinição.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 11 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            -- Russian
            ('8a41613d-e588-41f1-84dc-f95b0cb7857b',
                null,
                '97c872de-cfbb-4d9c-a41c-a5840559ec44',
                E'Не стесняйтесь оставить свой комментарий и вообще поэкспериментировать с Comentario на этой странице! Вы также можете зарегистрироваться либо залогиниться с емэйлом `admin@admin` и паролем `admin`. Да, и не забудьте глянуть на **[Панель администратора](https://edge.comentario.app/en/manage/dashboard)**!\n\n---\n\n💡 *Этот демонстрационный сайт Comentario сбрасывается в исходное состояние каждую ночь, а его комментарии — еженедельно.*',
                '<p>Не стесняйтесь оставить свой комментарий и вообще поэкспериментировать с Comentario на этой странице! Вы также можете зарегистрироваться либо залогиниться с емэйлом <code>admin@admin</code> и паролем <code>admin</code>. Да, и не забудьте глянуть на <strong><a href="https://edge.comentario.app/en/manage/dashboard" rel="nofollow noopener" target="_blank">Панель администратора</a></strong>!</p><hr><p>💡 <em>Этот демонстрационный сайт Comentario сбрасывается в исходное состояние каждую ночь, а его комментарии — еженедельно.</em></p>',
                1,
                true,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 12 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                ''),
            ('9f152ef8-b121-43ca-8268-a938574dbc96',
                '8a41613d-e588-41f1-84dc-f95b0cb7857b',
                '97c872de-cfbb-4d9c-a41c-a5840559ec44',
                E'**Примечание:** пожалуйста, имейте в виду, что, поскольку Панель администратора на этом демо-сайте находится в открытом доступе, любые введённые вами данные (например, емэйл) будут видны всем вплоть до следующего момента сброса.',
                '<p><strong>Примечание:</strong> пожалуйста, имейте в виду, что, поскольку Панель администратора на этом демо-сайте находится в открытом доступе, любые введённые вами данные (например, емэйл) будут видны всем вплоть до следующего момента сброса.</p>',
                0,
                false,
                true,
                false,
                false,
                current_timestamp - interval '6 days 20 hours 13 minutes',
                '39a71854-bcfd-42d5-af62-5e931d7a72d8',
                '')
        on conflict (id) do update
            set
                page_id        = excluded.page_id,
                markdown       = excluded.markdown,
                html           = excluded.html,
                is_sticky      = excluded.is_sticky,
                is_approved    = excluded.is_approved,
                is_pending     = excluded.is_pending,
                is_deleted     = excluded.is_deleted,
                ts_created     = excluded.ts_created,
                user_created   = excluded.user_created,
                pending_reason = excluded.pending_reason;

    -- Actualise the number of comments for the domain and domain pages
    update cm_domains
        set count_comments = (select count(*) from cm_comments c where c.is_deleted != true);
    update cm_domain_pages p
        set count_comments = (select count(*) from cm_comments c where c.page_id=p.id and c.is_deleted != true);

    -- Delete all avatars except the admin's
    delete from cm_user_avatars where user_id != '39a71854-bcfd-42d5-af62-5e931d7a72d8';
    insert into cm_user_avatars(user_id, ts_updated, is_custom, avatar_s, avatar_m, avatar_l)
        values
            ('39a71854-bcfd-42d5-af62-5e931d7a72d8',
                '2023-08-25 10:46:55.960122',
                true,
                E'\\xFFD8FFDB0084000201010101010201010102020202020403020202020504040304060506060605060606070908060709070606080B08090A0A0A0A0A06080B0C0B0A0C090A0A0A01020202020202050303050A0706070A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0AFFC00011080010001003012200021101031101FFC401A20000010501010101010100000000000000000102030405060708090A0B100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FA0100030101010101010101010000000000000102030405060708090A0B1100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FD68FDA03F6DFF00866FA4FC42F835E1BF1C5EF86BC63A2D95CC5A4DEDD20863BAB98903ED825E46F243200C1771FBB9C8A5F803FB6FFC324D2BE1EFC19F1178E2F7C4DE31D6AC6DA2D5AF6DA3F3A3B5B99632FB679781BC1210850DB4FDEC60D6DFED4DF0B3E2DFC6BF891E15F86BA57866C22F025E4A26F186BAA636BA78E36DE6D3E61BE3470A143264B17392A170C9FB2C7C2BF8B9F053E23F8ABE1AEADE19B097C0967319BC1FAEB18D6E92391B78B4F946F91103152CF82A5382C1805FC7FDA71B7FAE97E77EC79BD8FB4F633E5B5FDB7C1ED2D6E5FDDFD636E6F7797ED1FA7F2709FF00AAB6E55ED6DED393DAC39AF6F657E7F677BF37BFEC77B6BCDF64FFD9',
                E'\\xFFD8FFDB0084000201010101010201010102020202020403020202020504040304060506060605060606070908060709070606080B08090A0A0A0A0A06080B0C0B0A0C090A0A0A01020202020202050303050A0706070A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0AFFC00011080020002003012200021101031101FFC401A20000010501010101010100000000000000000102030405060708090A0B100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FA0100030101010101010101010000000000000102030405060708090A0B1100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FDFCC8CE335E25FB77FC7CF887FB3A7C27D3BC73F0EADF4E92E27D7E2B3B9FED2B5695046F0CADC0575C1DC8BCE7D6BC5FF6F3FDB13E367C16FDA0EC742F867ABCDA769DA669119BB8AFB4F0F6BA84D2B176FBEA37054D8B9460412C335C7FC6BFDBB7C0DFB507ECCDABFC3FF1DE80DA1F8AEDA4B6BCD35AD899ACEF258A55DCA8DF7A2631B49857C8FF006CD7E29C5FE28E46F0D99E4F86C44A86328C66A126B954A7157B425AABDD38A52B5DED7B9FAB70D787D9BAAF80CCEBD18D6C355945CA2B5718C9DAF28F6B3E676BD96F63E99FD847E3DFC44FDA2BE136A1E3AF88B6DA7477106BF2D9DB7F66DAB4486348626C90CED93B9DB9CD7B6646719AFCFBF82DFB77F81BF661FD99746F87DE05D00EB9E2A9DAE6F3516B9CC367672CB3315576FBD2B0411E55303FDB15D7FEC19FB627C6CF8D3FB41DFE85F133579B51D3B53D2243690D8E9E12D74F9A260EBF714ED0C9BD72EC49214669F08F8A3912C365993E27112AF8CAD1829C92E6519C95ED3968AF76A2D46F67BDAC1C4BE1F66EEBE3F33A1463470D4A52718BD1CA3176BC63DACB995ED75B5CFB0FC5B17853FB02EAF3C6B0D8B6996D034D78FA9223431C6A09676DE0800004926BF3D7E27F8B7C15FB657C7ED17E097C03F85DA1E85A14DAA059F5CB2D0A186F2EE14CB4D70CCAA0C712C618AA7563B4B72428FBCBE34FC23F0EFC73F86FA8FC33F155E5F5BD96A28A24974FB93148ACAC194FA300C012AC0A9C608AF27FD8CBF61FB7FD9835DD7FC53AFF00882DB59D4EF64FB2695790C0C9E4D88218EE56FBB23B63700480235C1E4D7A7C7DC3FC43C519CE0B2DA54A2B03277AF534E7B45DFD9EBAC5492B271BDDBD6C934FCFE0ECE725E1FCAF158EA9524F17156A50D796ED5B9FB369BBDA56B25A5DBD3E64F85DE2FF00057EC6FF001FB5BF825F1F3E17687AEE8706AA561D6EF741866BCB489F0D0DC2B3293244D195664EAA72579054FE85F84A2F0A7F605ADDF82A1B15D32E6059ACDB4D4458648D802AEBB000410410457877ED99FB0EDB7ED3BAFE83E2BF0FEBF6DA36A766E2D356BC9A067F3AC7961855FBD22367682402246C91815EB3F05BE11F873E067C37D3BE19F856F2FAE2CB4E4611CBA85C992466662CC7D141624855014670051C03C3FC43C2F9C6332DAB4A2F03177A1534E7B49DFD9E9EF49453B372B59AD2E9A48E32CE724E20CAF0B8EA7524B17256AB0D796E95B9FB26DABA51BDD3D6CD3BFF00FFD9',
                E'\\xFFD8FFDB0084000201010101010201010102020202020403020202020504040304060506060605060606070908060709070606080B08090A0A0A0A0A06080B0C0B0A0C090A0A0A01020202020202050303050A0706070A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0AFFC00011080080008003012200021101031101FFC401A20000010501010101010100000000000000000102030405060708090A0B100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FA0100030101010101010101010000000000000102030405060708090A0B1100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FDFCA28A2800A28A2800A28A2800A2BE69FDBA7F6CDF893FB2FF008A740D0FC11E1CD12F61D5B4F9E79DF558A666564915405F2E45E307BE6BC2BFE1EDFF001FFF00E841F07FFE035D7FF1FAFCCB3DF17382F87335AB97636A4D55A76524A0DAD526B5F468FBDCA7C36E28CEF2EA78DC2C22E9CEED5E493D1B5B7AA3F42E8AFCF4FF0087B7FC7FFF00A107C1FF00F80D75FF00C7EBDD7F617FDB37E24FED41E29D7F43F1BF87344B28749D3E09E07D2A2995999E46521BCC91B8C0ED8A322F17382F88F35A59760AA4DD5A97514E0D2D136F5F44C336F0DB8A324CBAA6371508AA70B376926F5696DEACFA5A8A28AFD34F820A28A2800A28A2800A28A2800A28A2800A28A2803E15FF0082C0D93278A7C0DA8EDE24D3F508B3EEB2407FF66AF8D6BEEEFF0082BFE8AF3F82BC15E2209F2DAEAF776CCD8FF9EB0AB81FF904D7C235FC13E3661E543C48C637B4BD9B5FF82E0BF34CFEC0F0BAB2ADC0F85FEEF3AFFCA92FD1A0AFB2FF00E08FDA7BBF897C75AA6DF963B1D3E2DDEED24EDFFB2D7C695F7A7FC12134092D7E1D78C3C50D190B7BAE416CAC475F260DC7F59AABC12C34B11E23E11ADA0AA49FFE0B92FCDA178A55D51E07C52EB2E44BFF00038BFC933EC0A28A2BFBD0FE400A28A2800A28A2800ACCF19F8B744F01784B53F1B788EE0C561A4D84B7778EA324471A166C0EE70381DCE2B4EBE67FF82A5FC52FF8433F67E8BC096771B6EFC57A8A5BB28EBF658712CA7E848890FB39AF038AB3BA7C37C3B8ACCE7FF2EA0DABF596D15F3934BE67B3C3B94CF3CCF30F808FFCBC924FCA3BC9FCA29BF91E9FF093F6B8FD9F7E35F956DE07F88F64D7D201FF0012ABF26DAE813FC22393058FFBBB87BD7A4820F4AFC4CDC7706CF20E41F43EB5ECBF053F6F0FDA23E0A986C2D3C5ADAE6931607F64EBECD3A2AFA2484F991FB618A8FEED7E01C33F48AC3D5946967B86E4FF00A794B55F383774BBB527E48FD8F3DF052A453A99457BFF0072A68FE534ADE978AF367EA7515F3FFECFFF00F0515F81FF0019DE0D07C43747C2BAE4A42AD8EAD32F9133FA4571C2B1F456D8C7B035EFE1830C839AFE87C973FC9B88B06B1596D78D58778BDBC9ADE2FC9A4CFC5B35C9B34C8F13F57C75274E5E6B7F34F66BCD368F9EFF00E0A75E1193C4BFB2B5FEA90C419B42D5ACEFFA72177985FF00F1D989FC2BF3408C1C1AFD87F8F5E0B4F889F05BC55E08316F7D4F40BA8211FF004D4C4C50FE0E14D7E3C025806618240247A1AFE50FA45E59F57E26C2E392D2AD2E5F9C24EFF84A27F4478298FF006D9057C2BDE9D4BFCA695BF18C800C9C0AFD3BFF00826D7847FE116FD93B42BB74DB26B37577A8C831D43CC510FF00DF11A57E621DD83B065B0768F53DABF637E0B78413C03F08BC33E0A58761D2F41B4B6917FDB485431FFBEB26B4FA3965BEDB88B178D6B4A74D47E73927F94191E3663BD964587C2A7AD4A9CDF2845FEB2474F452160A324E2BC03F680FF828AFC0FF0082F24FA0F87EE8F8AB5C88956B1D2665F2217F496E39553EAAA1D87702BFAAF3ACFF0026E1DC1BC56655E34A1DE4F7F24B793F249B3F9EB2AC9B34CF313F57C0D27525E4B6F36F64BCDB48FA00903AD79B7C5BFDADFF0067DF829E6DB78E7E23D92DF46A7FE255604DCDD13FDD31C792A7FDEDA3DEBF3EBE35FEDE3FB447C6A69AC2EBC58DA16932E47F64E80CD0232FA492E7CC93DF2C14FF0076BC6B71DC5B3C93927D4FAD7F3C7137D22B0F4A52A59161B9FF00E9E55D17CA09DDAECDC979A3F69C8BC14A934AA66F5EDFDCA7ABF9CDAB7ADA2FC99FB41E0CF16E89E3DF09699E36F0E5C196C356B08AEECE461826391032E476383C8EC735A75F33FF00C12D3E297FC267FB3F4BE04BCB8DD77E14D45EDD54F5FB2CD99623F404CA83D9057D315FBFF0AE774F8938770B99C3FE5EC1376E92DA4BE524D7C8FC7388B299E479E623012FF97726979C778BF9C5A7F302401935F9ABFF000538F8A5FF0009EFED1F2F852CEE03D9F852C12C5429CAFDA1F12CC7EB96443FF5CEBF4A64DFB0F978DD8E33D335F997FB407EC2FF00B57E81E29D5BC6FAA7850789D751BF9EF2EB50F0E486E0B3C8E5D89848128EBD9580C75AFCB7C79867D8BE15A783CBB0F3A919CF9AA38272B460AE934B5B3934EF6B2E5D4FD03C20965187CFEA627195A309463682934AEE4F569BD2E926ADBFBDA1E01454DA869F7FA4DEBE9BAAD94D6B7119C496F731347229F42AC011F9542411C115FC4D284E127192B347F5326A4AEB60E08C11907A835ED7FB3CFEDE1F1C3E01183464D57FE120F0FC6403A26AF2B37949E90CBCBC5EC3E64FF66BC528AF5326CF738E1FC62C565D5E54AA2EB17BF935B35E4D35E470E659565D9C615E1F1B495483E8D7E29EE9F9AB33F55FF67CFDB4FE097ED110C5A7681AE7F666B8CB993C3FAAB2C7704F19F2CE76CC3AF2849C75515F9A7F1D7C1C7E1FFC67F15F82826D4D37C43770C231FF002CFCD629FF008E15AE5A296486559A19191D18323A31055874208E41F7156FC45E24D7FC5BABCBE20F146B171A85F4E104F7977297965DA8114B31E588555193CF15F73C69E2562B8EB23C361F30A296228C9B538E8A5192B3BC7A3BA8BD1D9EBA2B1F27C2FC0F86E12CD2BD6C1546E8D58AF725AB8C93BAB4BAAB392D55D69AB3A0F80DE10FF84FBE36784BC1AD1EE4D47C456914C31FF2CFCD567FFC715ABF4AFF00683FDB4BE09FECEF0CBA7F8835DFED3D702931E81A532C9700F38F30E76C23A72E41C7406BF2D3C3BE24D7FC23AC45E20F0BEB371A7DFC01C417969294962DC8518AB0E549566191CF355259A59E579E7919DE462CEEEC4B331EA493C93EE69F05F8978AE05C8B1386CBE8A788AD24DCE5AC6318AB2B47ACAEE4F5765A68EE1C51C0F86E2DCD6856C6D46A8D28B5C91D1CA4DDDDE5D1594568AEF5D51ED3FB437EDE3F1C3E3E99F466D53FE11FF0FC995FEC4D22665F353D26978797DC7CA9FECD78A700600C01D00A28AF85CE73DCE388318F1598D7955A8FAC9EDE496C979249791F5996E559764F85587C15254E0BA25F8B7BB7E6EEC28A0027802A6D3EC2FB56BD4D374AB29AEAE24388EDEDA2692463E8154127F2AF2E309CE4A31576CEE6D455DEC7D09FF04C7F8A5FF0817ED1F17852F2E0259F8AEC1EC5831C2FDA1332C27EB95741FF005D2BF4A81046457E657ECFFF00B0C7ED5FAFF8AB49F1BE97E131E185D3AFE0BCB5D47C4521B72AF1B87522100CA7A7755073D6BF4D23DFB07998DD8E71D335FDB3E03433EC270AD4C1E63879D38C27CD4DCD38DE33576927AD949377B59F3687F2D78BF2CA7119FD3C4E0EB4672946D35169D9C5E8DDB4BB4D2B6FEEEA2D0403D451457EE27E4A6278C7E1A7C3DF8856A6CBC77E08D27588B6E026A7A7C73E07B17048FC2BC97C55FF0004E1FD92FC4ECD2C1F0F25D2A46EAFA3EA93C23F042CC83F2AF75A2BC5CCB87387F39D71D84A755F7942327F7B573D5C067B9D657A613133A6BB46524BEE4EC7CA7AD7FC1247E04DD65B43F1EF8AEC8F6124F6D301F9C40FEB5CCEA9FF00047BD25D59B44F8F17519FE14BCF0FA3FE65255FE55F695787FED7DFB6AF837F667D18E89A6AC3AAF8B6EE1DD63A4799F240A7A4D70472A9E8BF79F18181961F9F711787DE13E519754C766584853A71DDA94E3E8928C95DBE896ACFB4C938D3C46CCB1B0C1E071329CE5B27184BE6DCA2EC9756F447C6BFB4BFEC4369FB337875359F12FC75D1AEEEAE491A6E8D1E992A5D5DE08C9501D82A8EEED851D392403E0B5B7F113E22F8CFE2B78BAEFC75E3FD7A6D4753BD7CCD7131E001D11147088BD028E055DF82DF0BF58F8CFF0014F43F865A18612EAD7E914B32AE7C8847CD2CA47A24619BF003BD7F1AE72F2ACF33F54720C23A54E7250A70E694A526DD936E4DEB26F65A2DAEF77FD3796AC7E57947B4CDF10AA4E29CA72E5518A495DD924B44BABD5EFA6CB97AF7AFD9A3F622B4FDA67C3CFAC786BE3AE8D69756A40D4B46934C95EEAD324E0B29750CA7B3AE54F4E0820796FC68F85FAC7C18F8A7AE7C32D73734DA45FBC51CCCB8F3E13F345281E8F1956FC48ED54BE1E7C45F19FC29F175A78EBC01AF4DA76A764F986E213C107AA3A9E1D1BA1539068C9A5956479FBA39F611D5A70938548734A328B4ECDA716B58B5B3D1ED75BA7992C7E69947B4CA310A9CE494A12E5528B4D5D5D34F46BAAD56FAECFEC7D2FF00E08F7A52286D6BE3C5D487F896CFC3E89FABCADFCABA6D17FE0923F02AD486D73C7BE2BBC3DC473DB420FE5113FAD779FB20FEDABE0DFDA5F461A26A4B0E95E2DB48775F691E67C93A8EB35B93CB27AAFDE4CE0E4618FB857F6570EF87BE13E6D9753C7E5B84854A72D9B94E5EA9A949D9AEA9ABA3F98F3BE34F11B2DC6CF078EC4CA138EE94611F9A718ABA7D1ADCF0AF0A7FC1387F64BF0C30967F87936AB22F47D63559E61F8A06543F957ACF83BE1A7C3CF8796A2CFC09E07D27478F6ED2BA669F1C1B87B94009FC6B728AFD072DE1CE1FC9B5C0E129D27DE308C5FDE95CF8CC7E7B9D668AD8BC4CEA2ED2949AFB9BB0600A28A2BDA3C90A28A2800A3A75A2BE7FFDB9FF006C8B2FD9CFC2A3C27E0EB88A7F186AD6E4D92300CBA7C2720DCC83B9CE4229FBCC093C29CF919F67B96F0DE555330C7CF969C15DF76FA24BAB6F448F4F27CA31D9EE630C160E3CD39BF925D5B7D12DDB29FEDAFF00B7568BFB3FD94BF0FF00E1FC905FF8CAE21E4300F0E948C389251FC5211CAC7F466C0C06FCE3F1078875CF15EB775E24F12EAD717FA85F4ED35E5E5D485E49A43D5989EA7F90E0600A8B54D5352D6F52B8D6758BF9AEAEEEE669AEAEAE242F24D231CB3B31E4927926A0AFE08E3EF10337E3BCCBDAD77C9422DFB3A69E915DDF793EAFE4ACB43FAFF84383B2DE11C07B2A2B9AACBE39BDE4FB2ED15D17CDDDEA15F74FFC1287E037F67689A9FED01AF59625D43769DA0975E90230F3E51FEF480203E9137AD7C6FF000A7E1C6BDF177E2368FF000DBC3484DE6B17C90249B72215EAF29F6440CE7D96BF5F7C07E0BD07E1D78334CF02F862D443A7E93631DADA478E76228009F527A93DC926BF46F003847FB533C9E775E3FBBC3E90ECEA497FED91D7C9B8B3E2BC61E24FECFCA2395D197BF5F5979413FF00DB9E9E69491F237FC1583E04FDB749D2BF680D0ACBF7964574DD78A2F5859898253FEEB968C9FF00A689E95F0D57ECD7C46F02E83F13BC09AB7C3FF1341E6586AF6125ADC8C72A186030F46538607B1515F8FF00F117C09AF7C30F1DEADF0F7C4D16CBFD1EFE4B5B8E3872A7871FECB2ED61ECC2A3C7FE12FECBCFE19CD08FEEF13A4BCAA456BFF8146CFCDA932BC1EE22FED1C96596D57EFD0F87CE0DE9FF0080BBAF24E28A3E1FF10EB9E14D6ED7C4BE19D5AE2C350B19D66B3BCB590A490C83A3291D0FF31C1C835FA37FB147EDD7A2FED016517C3FF88324161E32B78780A0243AAA28E64887F0C8072D17D59723217F362A7D2F54D4B44D4ADF59D1EFE6B5BBB49966B5BAB790A490C8A72AEAC39041E41AFCF3807C40CDF81332F6B41F3D0935ED29B7A49775DA4BA3F93BAD0FB3E2FE0ECB78BB01ECAB2E5AB1F826B78BECFBC5F55F3567A9FB5BD7A515F3FF00EC2FFB64597ED19E153E13F18DC45078C349B706F514055D4211802E631D8E701D47DD6208F95863E80AFEF7C873DCB78932AA7986027CD4E6AEBBA7D535D1A7A347F206719463B22CC6782C64796707F26BA34FAA7BA61451457AE7981451450071BF1FBE2ED9FC0BF84BACFC4EBCD22E2FFF00B36DB743696D133196563B503100EC4DC41673C2A827D2BF25BE20F8FBC55F143C67A8F8FBC6BAA35E6A7AA5C19AEA73C0C9E02A8FE145501557B2802BF6666862B985EDEE23574752AE8EB90C0F5041EA2BE44FDAB7FE0995A178BBED3E3BFD9E62B7D2B546264B8F0E3B04B4BA3D4984F481CFF77FD59CFF00075AFC1BC6DE0AE2BE2AC1D2AD96CF9E9514DBA2B49397F3AD6D276D14746B5E5BB9347EC1E15714F0EE415EA51C74792A54692AAF5497F2BFE557D5BD53D39ACA299F045157FC4DE17F11F8335DB9F0C78B343BAD3751B39365D595E42639226F707B1EA0F4239048AEABF674F821AF7ED07F1674CF86DA2F991C571279BA9DE22E45A5A211E6CA7DF042AFABB28AFE3BC26578FC76650C052A6DD69C94146D67CCDDACEFB6BBDF6EA7F4B6231D84C2E0A58BA934A9C62E4E5D3952BDFCF4DADBF43EAEFF008253FECF8DA76957FF00B43788EC7125FABD8787448BD200DFBF9C67FBCEA2307D11FB357D9B59FE15F0C689E0BF0DD8784BC35A7A5AE9FA6DA476D676F18E238D142A8F7E075EE79AD0AFF4578338630DC21C39432CA5AB82BC9FF34DEB297DFB76492E87F15714E7F5F8973CAB8FA9A293B457F2C56915F76FDDB6FA857C51FF000556FD9D9A68ACFF0068CF0C5864C4B1D8789446BFC19C41707E84F94C7D0C7E95F6BD6778B7C2BA178E3C317FE0FF0013E9E977A7EA76925B5E5BC838923752AC3D8E0F07B1C1A8E35E17C3718F0E57CB2AE8E4AF097F2CD6B17F7E8FBC5B5D47C2BC415F8673CA58EA7AA4ED25FCD17F12FD579A4FA1F8B945771FB44FC11D7FF67CF8B1A9FC36D737C91DBBF9BA65E32E05DDA39262947BE0156F47561DAB96F0CF85FC45E33D76DBC31E13D12EB51D46F24F2ED6CACE132492B7B01E9DCF4039240AFF003B7179663F05994F01569B55A327071B5DF3276B24B7D76B6FD0FED4C3E37098AC147174E69D3947994BA72B57BF969BDF6EA5AF87DE3EF157C2FF0019E9DE3EF056A8D67A9E977026B59C7232382AC3F891949565EEA48AFD69F803F176CBE3A7C25D1BE2759E937161FDA56DBA6B4B98994C52A9DAE149037A6E076B8E19483EB5F3A7ECA5FF0004CAD0FC23F66F1D7ED0D15BEABA9A9125BF86D183DA5B1EA0CC7A4EE3FBBFEAC7FB7D6BEBB82186DA14B7B7895238D42A222E0281C0000E82BFB13C12E0AE2BE15C1D5AD994F9295649AA2F59297F3BD6D176D1C756F4E6B38A47F34F8ABC53C3B9FD7A747031E7A94DB4EAAD135FCABF995F54F44B5E5BA9363A8A28AFDE4FC7C28A28A0028A28A00F37FDA1FF00658F851FB49683F60F1BE91E4EA3044574ED72C805BAB53E81B1874CF546CA9ED83CD60FEC73FB22E8FF00B2CF85F5082E7548755D7355BA26F7558EDCC63C846221894124A800EE619E5D8F2405AF66A2BC0970B70FCF3E8E74F0F1FACC534A76B3D74BBE8DDB44DABA4DABD8F6A3C459D47279656AB3F61269F2F4D35B2EA95F56968DA4ED70A28A2BDF3C50A28A2803C67F6C5FD91747FDA9BC2FA7C16DAA43A56B9A55D0365AAC96E641E43B01344C01058103728CF0EA3900B56EFECF1FB2BFC28FD9B341361E08D27CED4678C2EA3AE5E80D75747D0B63E44CF445C28EF93CD7A4D15E04785B87E19F4B3A5878FD6649273B5DE9A5D744EDA3695DA495EC7B52E22CEA593C72B759FB08B6F97A6BAD9F56AFAA4F44DB76B8514515EF9E2851451401FFD9')
        on conflict (user_id) do update
            set
                is_custom = excluded.is_custom,
                avatar_s  = excluded.avatar_s,
                avatar_m  = excluded.avatar_m,
                avatar_l  = excluded.avatar_l;
